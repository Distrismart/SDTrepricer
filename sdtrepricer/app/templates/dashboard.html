<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>{{ request.app.title }} Dashboard</title>
    <link rel="stylesheet" href="/static/css/dashboard.css" />
  </head>
  <body>
    <header>
      <h1>{{ request.app.title }} â€“ Europe Repricer</h1>
      <p class="subtitle">Real-time visibility into Buy Box performance and system health.</p>
    </header>
    <main>
      <section class="metrics">
        <h2>Marketplace Performance</h2>
        <table id="metrics-table">
          <thead>
            <tr>
              <th>Marketplace</th>
              <th>Buy Box SKUs</th>
              <th>Total SKUs</th>
              <th>Buy Box %</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>
      <section class="health">
        <h2>System Health</h2>
        <div id="health-status"></div>
      </section>
      <section class="alerts">
        <h2>Alerts</h2>
        <ul id="alerts"></ul>
      </section>
      <section class="settings">
        <h2>Configuration</h2>
        <form id="settings-form">
          <label>
            Max price change per day (%)
            <input type="number" step="0.1" name="max_price_change_percent" required />
          </label>
          <label>
            Step-up percentage when holding Buy Box (%)
            <input type="number" step="0.1" name="step_up_percentage" required />
          </label>
          <label>
            Step-up interval (hours)
            <input type="number" name="step_up_interval_hours" required />
          </label>
          <label class="checkbox">
            <input type="checkbox" name="test_mode" />
            Enable test mode (simulate repricing updates)
          </label>
          <button type="submit">Update Settings</button>
        </form>
      </section>
      <section class="actions">
        <h2>Manual Controls</h2>
        <form id="manual-reprice-form">
          <label>
            Marketplace code
            <input name="marketplace_code" maxlength="2" required />
          </label>
          <button type="submit">Trigger Repricing</button>
        </form>
        <form id="manual-price-form">
          <label>Marketplace code<input name="marketplace_code" required /></label>
          <label>SKU<input name="sku" required /></label>
          <label>Price<input name="price" type="number" step="0.01" required /></label>
          <label>Business price<input name="business_price" type="number" step="0.01" /></label>
          <button type="submit">Submit Manual Price</button>
        </form>
        <form id="bulk-upload-form" enctype="multipart/form-data">
          <label>Marketplace code<input name="marketplace_code" required /></label>
          <label>Bulk price file<input type="file" name="file" accept=".csv,.xml" required /></label>
          <button type="submit">Upload Feed</button>
        </form>
        <div id="action-status"></div>
      </section>
      <section class="test-mode">
        <h2>Test Mode Data</h2>
        <form id="test-floor-form" enctype="multipart/form-data">
          <label>Marketplace code<input name="marketplace_code" required /></label>
          <label>Floor price file<input type="file" name="file" accept=".csv" required /></label>
          <button type="submit">Upload Floor Prices</button>
        </form>
        <form id="test-competitor-form" enctype="multipart/form-data">
          <label>Marketplace code<input name="marketplace_code" required /></label>
          <label>Competitor offers file<input type="file" name="file" accept=".csv" required /></label>
          <button type="submit">Upload Competitors</button>
        </form>
        <div id="test-mode-status"></div>
        <h3>Simulated Price Outcomes</h3>
        <table id="simulation-table">
          <thead>
            <tr>
              <th>Timestamp</th>
              <th>Marketplace</th>
              <th>SKU</th>
              <th>Old Price</th>
              <th>New Price</th>
              <th>Details</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>
    </main>
    <script src="/static/js/dashboard.js"></script>
  </body>
</html>
